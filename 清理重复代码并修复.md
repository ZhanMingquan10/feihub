# æ¸…ç†é‡å¤ä»£ç å¹¶ä¿®å¤

## ğŸ”§ åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ

åœ¨å®å¡”ç»ˆç«¯æ‰§è¡Œï¼š

```bash
cd /www/wwwroot/feihub/backend/src/lib

# å¤‡ä»½
cp feishu-puppeteer.ts feishu-puppeteer.ts.backup9

# ä½¿ç”¨ Python è„šæœ¬æ¸…ç†é‡å¤ä»£ç 
python3 << 'PYTHON_EOF'
file_path = '/www/wwwroot/feihub/backend/src/lib/feishu-puppeteer.ts'

with open(file_path, 'r', encoding='utf-8') as f:
    lines = f.readlines()

# æ‰¾åˆ°å¹¶ä¿®å¤é‡å¤çš„ä»£ç 
for i in range(len(lines)):
    # æ‰¾åˆ° "å¦‚æœè‹±æ–‡æ—¥æœŸè§£æå¤±è´¥ï¼Œä½¿ç”¨ parseChineseDate" ä¹‹åçš„ä½ç½®
    if 'å¦‚æœè‹±æ–‡æ—¥æœŸè§£æå¤±è´¥ï¼Œä½¿ç”¨ parseChineseDate' in lines[i]:
        # æ£€æŸ¥ä¸‹ä¸€è¡Œæ˜¯å¦æ˜¯ç©ºè¡Œå’Œé‡å¤çš„æ—¥å¿—
        if i + 1 < len(lines) and lines[i + 1].strip() == '':
            # æ£€æŸ¥å†ä¸‹ä¸€è¡Œæ˜¯å¦æ˜¯é‡å¤çš„ "å‡†å¤‡è§£ææ—¥æœŸ"
            if i + 2 < len(lines) and 'å‡†å¤‡è§£ææ—¥æœŸ' in lines[i + 2]:
                # åˆ é™¤é‡å¤çš„ç©ºè¡Œå’Œæ—¥å¿—
                lines.pop(i + 1)  # åˆ é™¤ç©ºè¡Œ
                lines.pop(i + 1)  # åˆ é™¤é‡å¤çš„ "å‡†å¤‡è§£ææ—¥æœŸ"
        
        # æ‰¾åˆ° parseChineseDate è°ƒç”¨åçš„ "è§£æåçš„æ—¥æœŸ" æ—¥å¿—
        # æŸ¥æ‰¾ "} else {" ä¹‹åçš„ä½ç½®
        for j in range(i, min(i + 10, len(lines))):
            if '} else {' in lines[j]:
                # æ£€æŸ¥åé¢æ˜¯å¦æœ‰é‡å¤çš„ "è§£æåçš„æ—¥æœŸ" æ—¥å¿—
                if j + 2 < len(lines) and 'è§£æåçš„æ—¥æœŸ' in lines[j + 2]:
                    # åˆ é™¤é‡å¤çš„æ—¥å¿—
                    lines.pop(j + 2)
                break
        break

with open(file_path, 'w', encoding='utf-8') as f:
    f.writelines(lines)

print("âœ… ä¿®å¤å®Œæˆ")
PYTHON_EOF

# éªŒè¯ä¿®å¤
echo "ä¿®å¤åçš„ä»£ç ï¼š"
sed -n '360,395p' feishu-puppeteer.ts
```

---

## âœ… ç„¶åé‡æ–°æ„å»º

```bash
cd /www/wwwroot/feihub/backend

npm run build

if [ $? -eq 0 ]; then
    echo "âœ… æ„å»ºæˆåŠŸ"
    pm2 restart feihub-backend
else
    echo "âŒ æ„å»ºå¤±è´¥"
    npm run build 2>&1 | tail -30
fi
```

