// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Document {
  id          String   @id @default(uuid())
  title       String   @db.VarChar(500)
  author      String   @db.VarChar(200)
  link        String   @unique @db.VarChar(1000)
  preview     String   @db.Text
  content     String?  @db.Text // 完整正文内容（保留格式）
  date        DateTime @default(now())
  views       Int      @default(0)
  tags        String[] // Array of tags
  aiSummary   String?  @db.Text // AI速读内容（兼容旧格式）
  aiAngle1    String?  @db.VarChar(200) // AI总结角度1
  aiSummary1  String?  @db.Text // AI总结角度1的内容
  aiAngle2    String?  @db.VarChar(200) // AI总结角度2
  aiSummary2  String?  @db.Text // AI总结角度2的内容
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Indexes for performance
  @@index([date])
  @@index([views])
  @@index([link])
  @@index([title]) // Index for search performance
}

model DocumentSubmission {
  id          String   @id @default(uuid())
  link        String   @db.VarChar(1000)
  status      String   @default("pending") // pending, processing, completed, failed
  error       String?  @db.Text
  documentId  String?  // Reference to Document after processing
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([status])
  @@index([createdAt])
}


