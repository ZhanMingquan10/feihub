# 修复正文提取问题 - 改进方案

## 🔍 问题分析

正文显示 "Help CenterKeyboard Shortcuts"，标签也是 "Help Center"、"Keyboard Shortcuts"、"Token Limit"，说明：
1. 内容提取阶段就提取到了导航栏内容
2. AI 基于错误的内容生成了错误的标签

## 🚀 解决步骤

### 第一步：在服务器上检查实际使用的文件

在服务器上执行：

```bash
cd /www/wwwroot/feihub/backend/src/lib

# 检查哪些文件存在
ls -la feishu*.ts

# 检查 documentProcessor.ts 导入的是哪个文件
cd ../services
grep "from.*feishu" documentProcessor.ts
```

### 第二步：根据实际情况修复

**如果使用的是 `feishu-puppeteer.ts`：**

需要修改该文件中的内容提取逻辑，更彻底地排除导航栏。

**如果使用的是 `feishu-server.ts`：**

我已经修改了这个文件，但可能服务器上的代码还没更新。

### 第三步：改进内容提取逻辑

无论使用哪个文件，都需要：

1. **更精确的选择器**：优先选择包含中文内容的区域
2. **更彻底的排除**：排除所有包含 "Help"、"Shortcut"、"Token" 的元素
3. **内容验证**：提取后验证是否包含中文，如果不包含中文且包含英文导航词汇，则跳过

## 📝 快速修复方案

在服务器上执行以下命令，我会根据输出提供具体的修复代码：

```bash
cd /www/wwwroot/feihub/backend/src/lib

# 检查实际使用的文件
ls -la feishu*.ts

# 检查导入
cd ../services
grep "from.*feishu" documentProcessor.ts

# 查找内容提取代码
cd ../lib
grep -n "querySelector\|innerText" feishu*.ts | head -30
```

---

请先执行第一步，把结果发给我，我会提供具体的修复代码。

