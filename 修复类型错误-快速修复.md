# ä¿®å¤ç±»å‹é”™è¯¯ - å¿«é€Ÿä¿®å¤

## ğŸ” é”™è¯¯åˆ†æ

é”™è¯¯ï¼š`Type 'string | null' is not assignable to type 'string'`

`page.evaluate` å¯èƒ½è¿”å› `null`ï¼Œä½† `content` å˜é‡è¢«å£°æ˜ä¸º `string` ç±»å‹ã€‚

## ğŸš€ å¿«é€Ÿä¿®å¤

åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š

```bash
cd /www/wwwroot/feihub/backend/src/lib

# æŸ¥çœ‹ç¬¬414è¡Œé™„è¿‘çš„ä»£ç 
sed -n '410,420p' feishu-puppeteer.ts

# ä¿®å¤ï¼šåœ¨ content èµ‹å€¼åæ·»åŠ  null æ£€æŸ¥
python3 << 'PYEOF'
file_path = 'feishu-puppeteer.ts'

with open(file_path, 'r', encoding='utf-8') as f:
    lines = f.readlines()

# æŸ¥æ‰¾ content = await page.evaluate çš„è¡Œ
for i, line in enumerate(lines):
    if 'content = await page.evaluate' in line:
        print(f"æ‰¾åˆ°ç¬¬ {i+1} è¡Œ: {line.strip()}")
        # åœ¨è¿™è¡Œåé¢æ·»åŠ  null æ£€æŸ¥
        # æŸ¥æ‰¾ä¸‹ä¸€ä¸ªéæ³¨é‡Šã€éç©ºè¡Œ
        j = i + 1
        while j < len(lines) and (not lines[j].strip() or lines[j].strip().startswith('//')):
            j += 1
        
        # åœ¨ä¸‹ä¸€ä¸ªæœ‰æ•ˆä»£ç è¡Œå‰æ’å…¥ null æ£€æŸ¥
        if j < len(lines):
            lines.insert(j, '      if (!content) content = \'\';\n')
            print(f"  åœ¨ç¬¬ {j+1} è¡Œå‰æ’å…¥ null æ£€æŸ¥")
        else:
            # å¦‚æœåé¢æ²¡æœ‰ä»£ç ï¼Œç›´æ¥è¿½åŠ 
            lines.append('      if (!content) content = \'\';\n')
            print(f"  åœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ  null æ£€æŸ¥")
        break

with open(file_path + '.bak3', 'w', encoding='utf-8') as f:
    f.writelines(lines)
    
with open(file_path, 'w', encoding='utf-8') as f:
    f.writelines(lines)

print("âœ… å·²ä¿®å¤")
PYEOF

# é‡æ–°æ„å»º
cd /www/wwwroot/feihub/backend
npm run build && pm2 restart feihub-backend && echo "âœ… ä¿®å¤å®Œæˆï¼"
```

---

## ğŸ“ æˆ–è€…æ›´ç®€å•çš„æ–¹æ³•ï¼šç›´æ¥ä¿®æ”¹èµ‹å€¼

```bash
cd /www/wwwroot/feihub/backend/src/lib

# æŸ¥çœ‹ç¬¬414è¡Œ
sed -n '414p' feishu-puppeteer.ts

# ä½¿ç”¨ sed åœ¨èµ‹å€¼åæ·»åŠ  || ''
sed -i '414s/await page.evaluate/await page.evaluate/g' feishu-puppeteer.ts
sed -i '414a\      if (!content) content = '\''\'\'';' feishu-puppeteer.ts

# æˆ–è€…ä½¿ç”¨ Python æ›´ç²¾ç¡®åœ°ä¿®å¤
python3 << 'PYEOF'
with open('feishu-puppeteer.ts', 'r', encoding='utf-8') as f:
    lines = f.readlines()

for i, line in enumerate(lines):
    if i == 413 and 'content = await page.evaluate' in line:  # ç¬¬414è¡Œï¼ˆç´¢å¼•413ï¼‰
        # åœ¨è¿™è¡Œåé¢æ·»åŠ  null æ£€æŸ¥
        lines.insert(i+1, '      if (!content) content = \'\';\n')
        print(f"âœ… å·²ä¿®å¤ç¬¬ {i+2} è¡Œ")
        break

with open('feishu-puppeteer.ts', 'w', encoding='utf-8') as f:
    f.writelines(lines)
PYEOF

cd /www/wwwroot/feihub/backend
npm run build && pm2 restart feihub-backend
```

---

æ¨èä½¿ç”¨**ç¬¬ä¸€ä¸ªæ–¹æ³•ï¼ˆPython è„šæœ¬ï¼‰**ï¼Œæ›´å¯é ã€‚

