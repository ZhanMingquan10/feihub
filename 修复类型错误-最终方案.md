# ä¿®å¤ç±»å‹é”™è¯¯ - æœ€ç»ˆæ–¹æ¡ˆ

## ğŸ” é”™è¯¯åˆ†æ

`page.evaluate` è¿”å› `string | null`ï¼Œä½† `content` æ˜¯ `string` ç±»å‹ã€‚

## ğŸš€ æœ€ç›´æ¥çš„ä¿®å¤æ–¹æ³•

åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š

```bash
cd /www/wwwroot/feihub/backend/src/lib

# æŸ¥çœ‹ç¬¬414è¡Œ
sed -n '414p' feishu-puppeteer.ts

# æ–¹æ³•1ï¼šç›´æ¥åœ¨èµ‹å€¼æ—¶å¤„ç† nullï¼ˆæ¨èï¼‰
python3 << 'PYEOF'
with open('feishu-puppeteer.ts', 'r', encoding='utf-8') as f:
    lines = f.readlines()

# æŸ¥æ‰¾ç¬¬414è¡Œï¼ˆç´¢å¼•413ï¼‰
for i, line in enumerate(lines):
    if i == 413 and 'content = await page.evaluate' in line:
        # ä¿®æ”¹è¿™ä¸€è¡Œï¼Œåœ¨æœ«å°¾æ·»åŠ  || ''
        new_line = line.rstrip()
        if new_line.endswith(';'):
            new_line = new_line[:-1] + ' || \'\';'
        else:
            new_line = new_line + ' || \'\''
        lines[i] = new_line + '\n'
        print(f"âœ… å·²ä¿®å¤ç¬¬ {i+1} è¡Œ")
        print(f"  åŸ: {line.strip()}")
        print(f"  æ–°: {new_line}")
        break

with open('feishu-puppeteer.ts.bak4', 'w', encoding='utf-8') as f:
    f.writelines(lines)
    
with open('feishu-puppeteer.ts', 'w', encoding='utf-8') as f:
    f.writelines(lines)
PYEOF

# é‡æ–°æ„å»º
cd /www/wwwroot/feihub/backend
npm run build && pm2 restart feihub-backend && echo "âœ… ä¿®å¤å®Œæˆï¼"
```

---

## ğŸ“ å¦‚æœæ–¹æ³•1ä¸è¡Œï¼Œä½¿ç”¨æ–¹æ³•2ï¼šåœ¨ä¸‹ä¸€è¡Œæ·»åŠ æ£€æŸ¥

```bash
cd /www/wwwroot/feihub/backend/src/lib

python3 << 'PYEOF'
with open('feishu-puppeteer.ts', 'r', encoding='utf-8') as f:
    lines = f.readlines()

# æŸ¥æ‰¾ content = await page.evaluate çš„è¡Œ
for i, line in enumerate(lines):
    if 'content = await page.evaluate' in line and i >= 410 and i <= 420:
        # åœ¨è¿™è¡Œåé¢æ·»åŠ  null æ£€æŸ¥
        # æŸ¥æ‰¾ä¸‹ä¸€ä¸ªéç©ºã€éæ³¨é‡Šè¡Œ
        j = i + 1
        while j < len(lines) and (not lines[j].strip() or lines[j].strip().startswith('//')):
            j += 1
        
        # æ’å…¥ null æ£€æŸ¥
        indent = '      '  # æ ¹æ®ä»£ç ç¼©è¿›è°ƒæ•´
        lines.insert(j, f'{indent}if (!content) content = \'\';\n')
        print(f"âœ… åœ¨ç¬¬ {i+1} è¡Œåæ·»åŠ  null æ£€æŸ¥ï¼ˆæ’å…¥åˆ°ç¬¬ {j+1} è¡Œï¼‰")
        break

with open('feishu-puppeteer.ts.bak4', 'w', encoding='utf-8') as f:
    f.writelines(lines)
    
with open('feishu-puppeteer.ts', 'w', encoding='utf-8') as f:
    f.writelines(lines)
PYEOF

cd /www/wwwroot/feihub/backend
npm run build && pm2 restart feihub-backend
```

---

## ğŸ“ æ–¹æ³•3ï¼šæ‰‹åŠ¨ä¿®å¤

å¦‚æœä¸Šé¢çš„æ–¹æ³•éƒ½ä¸è¡Œï¼Œæ‰‹åŠ¨ä¿®å¤ï¼š

```bash
cd /www/wwwroot/feihub/backend/src/lib

# æŸ¥çœ‹ç¬¬414è¡Œ
sed -n '414p' feishu-puppeteer.ts

# ä½¿ç”¨ nano ç¼–è¾‘
nano feishu-puppeteer.ts
```

æ‰¾åˆ°ç¬¬414è¡Œï¼Œå°†ï¼š
```typescript
content = await page.evaluate((pageTitle) => {
```

æ”¹ä¸ºï¼š
```typescript
content = (await page.evaluate((pageTitle) => {
```

ç„¶ååœ¨å¯¹åº”çš„é—­åˆæ‹¬å·åæ·»åŠ  `) || '';`

æˆ–è€…æ›´ç®€å•ï¼Œåœ¨è¿™è¡Œåé¢æ·»åŠ ï¼š
```typescript
if (!content) content = '';
```

---

**æ¨èä½¿ç”¨æ–¹æ³•1**ï¼Œç›´æ¥åœ¨èµ‹å€¼æ—¶å¤„ç† nullã€‚

